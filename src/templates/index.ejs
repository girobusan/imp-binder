<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IMP Binder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="view.css" />
  <meta name="description" content="The page description" >
  <script>
    function IframeLoaded(){
        console.log("Iframe loaded");
        const f = document.getElementById("display");
        window.document.title = f.contentWindow.document.title;
        //console.log(f.contentWindow.location.pathname)
        const p = f.contentWindow.location.pathname;
         window.location.hash = "#" + p
         .replace(/#[^#]+$/ , "")
    }
      //check if ...
      window.addEventListener("load" , ()=>{
        const f = document.getElementById("display");
         if(window.location.hash.length>3){
           const loc = window.location.hash.substring(1);
           const ifr = document.getElementById("display");
           ifr.setAttribute("src" , loc + "#view");

         }
         f.addEventListener("load" ,IframeLoaded);
      })

     //add editor
     if(window.location.protocol=="file:"){
       window.addEventListener( "load" , ()=>{
         const e = document.createElement("script");
         e.id="editorScript";
         e.src = "editor.js";
         const h = window.document.body;
         h.appendChild(e);
       });
     }

  </script>
  
</head>
<body>
  <nav id="menu">
  <ul>
    <li><a href="cover.html#view" target="display" data-title="O la la">Main</a></li>
    <li><a href="page.html#view" target="display">Second</a></li>
  </ul>
  </nav>
  <iframe name="display" id="display" src="cover.html#view" >!!
  </iframe>
</body>
</html>

